Perfecto. Voy a investigar cómo la herramienta CALDERA puede integrarse con tu plataforma Tectonic para apoyar tanto ejercicios ofensivos como defensivos en un Cyber Range. También voy a identificar escenarios relevantes que se alineen con tu enfoque en análisis forense y gestión de incidentes, y analizar cómo CALDERA puede ser utilizada para generar artefactos digitales realistas que fortalezcan el aspecto educativo y práctico de tu proyecto.

Te aviso en cuanto tenga los resultados listos.

## Capacidades principales de MITRE CALDERA (Red Team vs Blue Team) en entornos educativos  
MITRE CALDERA es una plataforma de *adversary emulation* (emulación de adversarios) que automatiza tácticas de ataque (red team) y también puede apoyar respuestas automatizadas (blue team) ([GitHub - mitre/caldera: Automated Adversary Emulation Platform](https://github.com/mitre/caldera#:~:text=MITRE%20Caldera%E2%84%A2%20is%20a%20cyber,teams%2C%20and%20automate%20incident%20response)). En el rol de red team, CALDERA permite construir perfiles de adversarios específicos (secuencias de TTPs basadas en MITRE ATT&CK) y lanzarlos en una red para probar defensas y vulnerabilidades de forma repetible ([Caldera](https://caldera.mitre.org/#:~:text=Autonomous%20Adversary%20Emulation)). Esto ayuda a **emular compromisos reales**: por ejemplo, ejecutar de forma automática técnicas de **acceso inicial, movimiento lateral, persistencia, exfiltración**, etc., tal como lo haría un atacante avanzado. Las técnicas disponibles cubren un amplio espectro mapeado a ATT&CK (incluyendo exploits, ejecución de comandos, robo de credenciales, movimientos vía SMB/WinRM, exfiltración por HTTP/DNS, entre otros) ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=Offensive%20Cyber%20Operations%20%E2%80%A2%20Automated%2C,ATT%26CK%C3%94%20Matrices%20Automated%20Adversary%20Emulation)) ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=%E2%80%A2%20Emulate%20real%20world%20adversaries,planning%20for%20autonomous%20cyber%20operations)). Para ello, CALDERA utiliza *agents* desplegados en los sistemas objetivo y conjuntos de “abilities” (scripts/acciones atómicas) que conforman las operaciones ofensivas.

En cuanto al **blue team**, CALDERA también soporta la evaluación de defensas y la automatización de respuestas. Por un lado, al emular ataques permite verificar si los controles de seguridad (AV, EDR, SIEM, etc.) los detectan y si los analistas identifican los indicios correspondientes ([Caldera](https://caldera.mitre.org/#:~:text=With%20Caldera%2C%20your%20cyber%20team,how%20to%20detect%20specific%20threats)). Adicionalmente, mediante su plugin “Response” es posible configurar **operaciones de respuesta automatizada** que se activan ante ciertas actividades ofensivas ([GitHub - mitre/response: A CALDERA plugin for autonomous incident response](https://github.com/mitre/response#:~:text=A%20MITRE%20Caldera%20plugin%20for,doing%20autonomous%20incident%20response)). En otras palabras, CALDERA puede lanzar secuencias de “contramedidas” blue team (por ejemplo, aislar un host comprometido, borrar un payload, recolectar evidencias) inmediatamente después de una operación roja, simulando la reacción de un equipo de respuesta a incidentes. De hecho, CALDERA está “diseñado para **asistir a equipos rojos** manuales *y automatizar la respuesta a incidentes*” ([GitHub - mitre/caldera: Automated Adversary Emulation Platform](https://github.com/mitre/caldera#:~:text=MITRE%20Caldera%E2%84%A2%20is%20a%20cyber,teams%2C%20and%20automate%20incident%20response)), lo que evidencia su orientación tanto ofensiva como defensiva. Esta capacidad dual la hace ideal para ejercicios de *purple teaming* (integración Red/Blue). Por ejemplo, un estudiante podría ejecutar un escenario de ataque automatizado con CALDERA y luego observar, a través de CALDERA mismo u otras herramientas, qué acciones de contención se dispararían en respuesta.

En un **entorno educativo**, CALDERA ofrece varias ventajas. Permite ahorrar tiempo y recursos al automatizar pruebas de seguridad rutinarias ([Caldera](https://caldera.mitre.org/#:~:text=Caldera%20helps%20cybersecurity%20professionals%20reduce,needed%20for%20routine%20cybersecurity%20testing)), lo cual es útil en laboratorios donde se necesita repetir ataques para múltiples estudiantes. Sus acciones están estandarizadas y basadas en ATT&CK, facilitando que los alumnos relacionen teoría (tácticas y técnicas) con práctica. Además, la plataforma incluye documentación extensa, tutoriales interactivos (*plugin* “Training”) y una comunidad activa, lo que facilita el aprendizaje autónomo ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=Research%20%E2%80%A2%20Train%20computer%20incident,documentation%20%26%20interactive%20tutorials%20Training)). De hecho, CALDERA se usa para **entrenar equipos de respuesta e investigadores forenses** en un entorno controlado ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=Research%20%E2%80%A2%20Train%20computer%20incident,documentation%20%26%20interactive%20tutorials%20Training)). Por ejemplo, se pueden simular brechas de seguridad de forma segura y luego pedir a los estudiantes que, como blue team, analicen los logs y evidencias generadas por esas brechas. En resumen, CALDERA brinda **emulación autónoma de adversarios** para el red team y herramientas para evaluar/automatizar la respuesta del blue team, siendo altamente aplicable en la enseñanza de análisis forense digital y gestión de incidentes ([A Beginner’s Guide to Adversary Emulation with Caldera – NVISO Labs](https://blog.nviso.eu/2023/08/25/a-beginners-guide-to-adversary-emulation-with-caldera/#:~:text=MITRE%E2%80%99s%20Caldera%20project%20is%20an,comprehensive%20view%20of%20an%20organization%E2%80%99s)).

## Integración de CALDERA con una plataforma tipo Cyber Range (Tectonic)  
 ([Tectonic](https://www.fing.edu.uy/inco/proyectos/tectonic)) *Arquitectura de un Cyber Range académico (Tectonic) integrando CALDERA.* En la capa de *Presentación* se ve a CALDERA junto a Moodle (gestión de contenido educativo) y Kibana (visualización de monitoreo), mientras que las capas inferiores muestran la orquestación con Python, IaC (Terraform, Packer, Ansible) e infraestructura virtual (AWS, Docker, libvirt). Esto ilustra cómo CALDERA se incorpora para la **simulación de ataques** dentro del entorno aislado de Tectonic ([Tectonic](https://www.fing.edu.uy/inco/proyectos/tectonic#:~:text=Tectonic%20is%20a%20cyber%20range,monitoring%20and%20automated%20attack%20simulations)).  

Integrar CALDERA en Tectonic u otro *cyber range* implica desplegar la infraestructura necesaria y coordinar los agentes dentro de los laboratorios virtuales. En la práctica, se suele instalar un **servidor CALDERA** central (por ejemplo, una VM Linux controladora) y **agentes CALDERA** (*Sandcat*, etc.) en las máquinas virtuales que actuarán como blancos del ataque. Tectonic facilita esto gracias a su enfoque de *Infrastructure as Code*: mediante **scripts de provisioning (Packer/Ansible)** se puede automatizar la instalación y configuración del agente en cada VM del escenario durante su despliegue ([Tectonic](https://www.fing.edu.uy/inco/proyectos/tectonic#:~:text=To%20achieve%20the%20deployment%20of,are%20extensively%20used%20for%20configuration)). Por ejemplo, se podría incluir en el *playbook* de Ansible de una estación Windows las tareas para descargar e iniciar el agente CALDERA al levantar el laboratorio. De hecho, una arquitectura de laboratorio automatizado reportada públicamente implementa un esquema similar: una VM Linux con el servidor CALDERA (versión 5.x) y otra VM Windows preparada con el agente CALDERA más herramientas adicionales de red team/blue team (como Atomic Red Team y Sysmon para monitoreo de eventos) ([AutomatedEmulation/README.md at master · iknowjason/AutomatedEmulation · GitHub](https://github.com/iknowjason/AutomatedEmulation/blob/master/README.md#:~:text=,Windows%20Client%3A%20Sysmon%20automated%20deployment)). Esta última combinación (agente + Sysmon) resulta muy útil, ya que el agente ejecuta las acciones maliciosas y Sysmon genera logs detallados de esas acciones para su posterior análisis forense.

La comunicación entre el servidor CALDERA y los agentes en las VMs del cyber range puede manejarse en la red virtual interna de Tectonic, manteniendo el tráfico de C2 aislado del mundo real. Es importante considerar aspectos de **red y autenticación**: por ejemplo, abrir el puerto del servidor CALDERA (por defecto 8888) en las VMs correspondientes, y suministrar al agente la URL del servidor al iniciarse. Tectonic, mediante su componente de orquestación en Python, podría incluso **automatizar el inicio de operaciones de CALDERA** una vez desplegado el escenario. Dado que CALDERA expone una API REST, es factible que Tectonic lance una operación (p. ej., un plan de ataque específico) vía API cuando el laboratorio esté listo, sincronizando así el comienzo de la “simulación de ataque” con la disponibilización del entorno para el estudiante. Alternativamente, el instructor o alumno (según el caso de uso) puede iniciar manualmente la operación ofensiva desde la interfaz web de CALDERA, la cual estaría accesible como parte del laboratorio. La integración con la capa de **monitoreo** también es clave: Tectonic incluye herramientas como Elastic Stack (Logstash/Elasticsearch, Kibana) y Packetbeat para capturar tráfico ([Tectonic](https://www.fing.edu.uy/inco/proyectos/tectonic#:~:text=Tectonic%20is%20a%20cyber%20range,monitoring%20and%20automated%20attack%20simulations)) ([Tectonic](https://www.fing.edu.uy/inco/proyectos/tectonic#:~:text=the%20systems%20and%20networks%20that,are%20supported%2C%20with%20more%20planned)), de modo que los eventos y tráfico generados por las acciones de CALDERA en las VMs se recolecten en tiempo real. Esto permite que los estudiantes usen Kibana u otras interfaces para analizar las alertas, logs y trazas de red producto del ataque automatizado, brindando una experiencia completa de ataque y defensa en el laboratorio. En síntesis, CALDERA puede integrarse a un cyber range como Tectonic instalando sus agentes en las VMs del escenario e incorporando la ejecución coordinada de ataques automatizados como parte del ciclo de vida del laboratorio (despliegue, simulación, teardown), todo ello soportado por la infraestructura declarativa y de orquestación que ofrece la plataforma.

## Escenarios de simulación recomendados con CALDERA en el Cyber Range  
A continuación se proponen **escenarios específicos** que pueden implementarse en Tectonic utilizando CALDERA, cubriendo varias etapas típicas de un ataque. Cada escenario está pensado para generar evidencias que luego puedan ser analizadas por los participantes (ejercicio de análisis forense y respuesta a incidentes):

- **Compromiso inicial:** Simular cómo un adversario obtendría el primer acceso a la red víctima. Por ejemplo, CALDERA (con el plugin **Access**) puede automatizar un vector de *phishing* donde un agente se introduce en una máquina víctima al ejecutar un adjunto malicioso. Con una habilidad de “User Execution” (ejecución de archivo Office con macro o un script PowerShell malicioso) se emula al usuario abriendo el documento infectado. Alternativamente, se podría simular la explotación de una vulnerabilidad en un servicio expuesto de la VM (por ejemplo, usando una habilidad que explote *EternalBlue* u otro CVE conocido si se dispone). Tras la ejecución del payload, el agente CALDERA quedaría activo en la máquina objetivo. **Artefactos generados:** Este compromiso inicial dejará múltiples huellas: registros de eventos del sistema (p. ej., *Windows Event ID 4104* si se ejecutó PowerShell con script, eventos de Application Crash si se explotó un servicio, etc.), creación de nuevos procesos sospechosos (el agente mismo corriendo en memoria) y posiblemente un fichero dropper en el disco. Un ejemplo práctico: ejecutar una técnica de *DLL hijacking* o *registro de inicio* para persistir el acceso inicial – esto generaría una entrada en el Registro de Windows (Run key) o un nuevo servicio instalado, lo cual es una evidencia que los estudiantes podrían detectar con herramientas forenses. CALDERA cuenta con numerosas técnicas para **automatizar la etapa de inicial **acceso**; por ejemplo, su librería Stockpile/Atomic Red Team ofrece TTPs como *T1204 User Execution* o *T1193 Spearphishing Attachment* que se pueden aprovechar.

- **Movimiento lateral:** Una vez comprometido un punto de la red, CALDERA puede emular cómo un atacante se desplaza a otros sistemas internos. Por ejemplo, utilizando credenciales robadas o vulnerabilidades de confianza, un agente CALDERA en la primera máquina podría ejecutar habilidades de *lateral movement*. Técnicas típicas incluyen: **ejecución remota via WMI** o WinRM en otra máquina Windows (mapeado a ATT&CK T1047/T1028), **PSExec/SMB** para transferir y ejecutar una carga en un host vecino, o incluso explotación de vulnerabilidades internas (como BlueKeep) si se quiere un caso más especializado. CALDERA facilita esto lanzando un nuevo agente (*spawn*) en la máquina remota objetivo si la técnica tiene éxito. **Artefactos generados:** El movimiento lateral suele producir evidencias como registros de autenticación en el equipo de destino (eventos de inicio de sesión exitoso desde la IP de la primera máquina, o eventos de creación de un proceso remoto). Por ejemplo, un movimiento lateral vía WMI provocará eventos WMI logs y de seguridad en Windows (Event ID 4624 de logon type 3 o 9, asociado al usuario usado en la conexión). Si se usó PSExec, quedarán servicios temporales creados en el registro del segundo host (ya que PSExec crea un servicio Windows para ejecutar comandos). Además, las herramientas empleadas (p. ej. un volcado de credenciales tipo Mimikatz antes de mover lateralmente) dejarán huellas: acceso a LSASS en memoria (eventos 4688 de proceso abriendo otro proceso, o dumps de proceso), archivos de volcado en disco, etc. Este escenario permite que los estudiantes busquen en los logs de ambos sistemas indicios de la intrusión propagada lateralmente, reforzando habilidades de correlación forense en red. Cabe destacar que CALDERA tiene técnica específicas de **“Lateral Movement”** ya integradas (por ejemplo, WinRM, SMB, RDP, etc. están contemplados en sus abilities) ([[PDF] caldera - Read the Docs](https://readthedocs.org/projects/caldera/downloads/pdf/latest/#:~:text=%5BPDF%5D%20caldera%20,which%20correlate%20to%20MITRE)), lo cual simplifica diseñar este ejercicio.

- **Exfiltración de datos:** Para completar la cadena de ataque, CALDERA puede simular la extracción de información sensible fuera de la red. Un escenario recomendable es que, tras moverse a un servidor crítico (por ejemplo, un servidor de archivos o base de datos simulado en el laboratorio), el agente CALDERA recopile ciertos archivos (documentos de ejemplo) y los **exfiltre**. Técnicas posibles: comprimir archivos locales en un ZIP (*Archive Collected Data*, ATT&CK T1560) y luego enviar ese archivo a un servidor externo controlado por el atacante mediante HTTP o HTTPS (*Exfiltration over C2 Channel*, T1041) – CALDERA podría simplemente hacer una petición HTTP POST con cURL o Powershell hacia una URL simulada, adjuntando los datos. Otra opción es simular exfiltración por canales encubiertos, por ejemplo fragmentar datos en consultas DNS (CALDERA tiene abilities para DNS exfiltration en Stockpile). **Artefactos generados:** Este escenario produce tanto **artefactos de sistema** como **tráfico de red** anómalos. En el host origen quedarían archivos temporales (el .zip creado, que el atacante podría borrar después – si no se borra, es evidencia directa). También pueden quedar comandos en el historial (por ejemplo, si usó *Invoke-WebRequest* de PowerShell, habrá eventos de PowerShell logging con la URL destino). Del lado de la red, un volcado de tráfico o herramienta de monitoreo (como Packetbeat en Tectonic) capturará la sesión de exfiltración – los estudiantes podrían identificar en Wireshark o Kibana una petición saliente inusual, por ejemplo a una URL desconocida, con un payload de cierto tamaño a horas indebidas. Si se usa DNS para exfiltrar, las consultas DNS con texto codificado serían claramente distinguibles en los logs de DNS. Este ejercicio permite practicar la detección de tráfico malicioso y la correlación con eventos en los hosts. CALDERA, al usar su agente para enviar datos fuera, estará generando esas trazas de forma realista que luego se analizan.

- **Actividades detectables por herramientas forenses (rastro del atacante):** Además de las fases anteriores, es útil simular acciones post-explotación que sean **visibles para analistas forenses**, forzando al atacante a “delatarse”. Por ejemplo, CALDERA puede ejecutar técnicas de **persistencia** en los sistemas comprometidos: creación de una clave de auto-inicio en el registro de Windows (ATT&CK T1547) o programar una tarea periódica maliciosa (T1053). Estas modificaciones son detectables mediante inspección forense (los alumnos podrían usar herramientas como Autoruns, revisores de Task Scheduler o registros para encontrarlas). Otra actividad es la **escucha en puertos/red**: si el agente abre un puerto de backdoor o establece comunicación de *beaconing* periódica, los monitores de red y los logs de firewall local lo reflejarán. Asimismo, se pueden simular intentos de *escalar privilegios* (p. ej., dumping de SAM hashes, uso de token manipulation) que dejen eventos de error o entradas en logs de seguridad. Incluso *anti-forense*: CALDERA podría borrar ciertas evidencias (e.g., limpiar el log de eventos con `wevtutil`) para que los estudiantes comprueben integridad de logs o recuperen información borrada con técnicas forenses. **Artefactos generados:** Cada una de estas acciones genera datos valiosos: modificaciones en el sistema de archivos (timestamps alterados, nuevos binarios en directorios sospechosos), cambios en el registro, logs del sistema que muestran utilización de utilidades de administración (por ejemplo, uso de `wevtutil` quedaría en Event logs). La idea es que las **“actividades maliciosas” queden entremezcladas con la actividad normal** en el sistema, de modo que el desafío educativo sea distinguirlas. Para lograr esa mezcla, CALDERA ofrece opciones como el *plugin* **Human** que ejecuta acciones benignas (simula un usuario real: navegar web, editar archivos, etc.) continuamente para generar “ruido” de fondo ([Human Plugin 101: Building a Human | by MITRE Caldera | Medium](https://medium.com/@mitrecaldera/human-plugin-101-building-a-human-b3792837f84e#:~:text=The%20Caldera%20Human%20plugin%20is,plugin%20that%20users%20can%20perform)). De esta forma, los artefactos que produzca el ataque no serán los únicos presentes, obligando a aplicar técnicas de análisis forense para filtrarlos de entre la actividad legítima. En los ejercicios, se recomienda habilitar herramientas de registro avanzado (como Sysmon, que ya mencionamos, o auditd en Linux) para recolectar detalles de estas acciones; CALDERA encaja bien aquí ya que sus técnicas activan justamente esos mecanismos de logging real en el sistema ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=%E2%80%A2%20Emulate%20real%20world%20adversaries,planning%20for%20autonomous%20cyber%20operations)). Por ejemplo, una técnica de movimiento lateral o ejecuciones de mimikatz dispararán eventos Sysmon (ID 10 de volcado de proceso, etc.), que luego el estudiante puede revisar en Kibana. En suma, este escenario abarca *todas aquellas huellas* que un atacante dejaría y que un analista forense **puede detectar con las herramientas adecuadas**, reforzando así la capacidad de los participantes para reunir evidencia digital sólida.

## Generación de artefactos digitales realistas con CALDERA para análisis forense  
Uno de los objetivos centrales al integrar CALDERA en estos laboratorios es lograr que las acciones simuladas produzcan **artefactos digitales realistas** – es decir, evidencias análogas a las de un incidente real, que puedan ser analizadas con técnicas forenses. Afortunadamente, CALDERA fue concebido con la idea de probar defensas y detecciones, lo que implica que sus ataques generan logs y telemetría aprovechables ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=Offensive%20Cyber%20Operations%20%E2%80%A2%20Automated%2C,planning%20for%20autonomous%20cyber%20operations)). A continuación se describen métodos y recomendaciones para generar dichos artefactos de valor forense:

- **Registros de eventos del sistema:** Las tareas que ejecuta CALDERA (sobre todo en Windows) aprovechan funciones del sistema operativo tal como lo haría un atacante real, detonando eventos en logs. Por ejemplo, si CALDERA lanza un *script* de PowerShell para realizar alguna acción, Windows registrará ese evento (vía PowerShell Operational log si está habilitado). Igualmente, al usar técnicas que involucren autenticaciones, creación de procesos, acceso a recursos sensibles, etc., se activarán eventos en el Log de Seguridad o de Aplicación. Para asegurarse de capturar esto, es recomendable preconfigurar las VMs del escenario con **políticas de auditoría adecuadas** (p. ej., activar “Audit Process Creation” para registrar comando/línea de comando de cada proceso creado, activar auditoría de acceso a objetos, etc.). Herramientas como **Sysmon** son muy valiosas: instalando Sysmon (configurado con un perfil que registre eventos de interés), cada acción maliciosa de CALDERA dejará una traza detallada (creación de proceso con hash, modificaciones de archivo, conexiones de red, carga de driver, etc.). Luego, esos logs pueden enviarse a un SIEM o a ElasticSearch (como en Tectonic) para que los estudiantes los exploren. Un caso real: la ejecución de **Mimikatz** vía CALDERA produciría eventos Sysmon ID 10 (volcado de proceso) y 4656/4663 de Windows (acceso a SAM/LSASS), los cuales son exactamente los artefactos que un analista forense buscaría al investigar robo de credenciales.

- **Tráfico de red y PCAPs:** Muchas técnicas emuladas (especialmente C2 y exfiltración) generan tráfico de red. CALDERA, al usar un agente que se comunica con el servidor de mando y control, produce tráfico periódicamente (beacons del agente). Además, si en un escenario se simula exfiltración o movimiento lateral, habrá conexiones adicionales (ej. SMB, HTTP, DNS malicioso, etc.). Es recomendable en el cyber range **capturar este tráfico** ya sea con herramientas como *Packetbeat* (como en la arquitectura de Tectonic) o directamente volcando a PCAP con tcpdump/Wireshark en el router virtual. Estos **pcaps** son una mina de oro para análisis forense de red: permiten practicar detección de patrones de ataque (por ejemplo, identificar en Wireshark la comunicación del agente con su servidor – que típicamente es HTTP POST a cierto URI con un user-agent peculiar, algo identificable para un analista ([Understand and detect MITRE Caldera with Zeek® | Corelight](https://corelight.com/blog/understanding-and-detecting-mitre-caldera-with-zeek#:~:text=Read%20how%20to%20identify%20C2,Zeek%20Caldera%20detector%20via%20GitHub))). Incluso se puede configurar un *IDS* (Snort/Zeek) en el entorno para generar alertas sobre ese tráfico, enriqueciendo los artefactos disponibles (logs de alertas de IDS sumados a los datos crudos). Por ejemplo, Corelight publicó detecciones específicas para identificar tráfico de CALDERA con Zeek ([Understand and detect MITRE Caldera with Zeek® | Corelight](https://corelight.com/blog/understanding-and-detecting-mitre-caldera-with-zeek#:~:text=Read%20how%20to%20identify%20C2,Zeek%20Caldera%20detector%20via%20GitHub)), lo cual indica que estos artefactos de red son lo suficientemente características para ser detectados; en un ejercicio, los estudiantes podrían validar si dichas firmas saltan ante el tráfico generado. Capturar tráfico también ayuda a obtener evidencia de exfiltración (p. ej., extraer del PCAP el archivo que el agente envió fuera).

- **Archivos modificados o creados (artefactos de filesystem):** Un buen laboratorio forense debe incluir artefactos en el disco que los analistas puedan recuperar. Las operaciones de CALDERA frecuentemente involucran crear o modificar archivos: por ejemplo, puede depositar un ejecutable (el agente) en `%TEMP%` o en otra ruta; puede generar *scripts* en disco, o como mencionamos, crear archivos comprimidos para exfiltración. También puede alterar archivos de configuración del sistema (añadiendo una clave de registro, o modificando un servicio). Todas estas acciones dejan rastro en el *filesystem*. Para explotarlo educativamente, se puede tomar instantáneas (*snapshots*) de discos antes y después del ataque y pedir a los alumnos que usen técnicas forenses de comparación o herramientas como *The Sleuth Kit* para ver diferencias. Otra idea es utilizar **metadatos de archivos**: por ejemplo, si CALDERA crea un documento o imagen como señuelo, ese archivo podría tener metadatos (fecha de creación, autor, etc.) que apunten al momento del ataque. Incluso el propio binario del agente CALDERA podría ser analizado (hash, fecha de compilación) como parte de la evidencia. Para generar variabilidad, CALDERA tiene un plugin **Builder** que recompila cargas en Go en tiempo real ([GitHub - mitre/caldera: Automated Adversary Emulation Platform](https://github.com/mitre/caldera#:~:text=,112%20%28documentation)), lo que podría cambiar hashes y evitar firmas triviales, similar a como haría un atacante polimórfico – esto obliga a los estudiantes a apoyarse en artefactos comportamentales más que en simplemente reconocer un hash conocido.

- **Ruido de actividad legítima:** Como mencionamos, el *plugin* **Human** permite simular un usuario legítimo en la máquina, realizando acciones cotidianas (navegar sitios web, editar documentos, etc.) ([Human Plugin 101: Building a Human | by MITRE Caldera | Medium](https://medium.com/@mitrecaldera/human-plugin-101-building-a-human-b3792837f84e#:~:text=The%20Caldera%20Human%20plugin%20is,plugin%20that%20users%20can%20perform)). Esto genera artefactos *benignos*: historial de navegador, archivos recientes, entradas de log de uso normal. Incluir este componente es **altamente recomendable en entornos educativos**, pues se asemeja a la realidad donde las evidencias del atacante están ocultas entre mucha actividad normal. La diversidad de comportamientos que Human puede realizar (descargas de páginas, uso de aplicaciones ofimáticas, búsquedas web, etc. ([Human Plugin 101: Building a Human | by MITRE Caldera | Medium](https://medium.com/@mitrecaldera/human-plugin-101-building-a-human-b3792837f84e#:~:text=Here%20is%20a%20summary%20of,behaviors%20that%20are%20currently%20available))) llena el sistema de trazas que obligarán a afinar la capacidad de discriminación de los analistas. Por ejemplo, el log de eventos podría tener decenas de eventos de apertura de aplicaciones legítimas o conexiones a sitios comunes (generados por Human), y entre ellos unos pocos eventos anómalos del ataque; o el disco puede contener muchos documentos legítimos creados por la simulación de usuario, además del malware camuflado. Un desafío interesante es incluir **artefactos señuelo**: es posible crear deliberadamente *artefactos falsos* que parezcan maliciosos pero que en realidad provienen de la actividad legítima (o viceversa), para ver si el estudiante identifica correctamente cuál corresponde al ataque real. Si bien CALDERA no genera “engaños” por sí mismo, un instructor podría plantar archivos con nombres sospechosos que no formen parte del ataque automatizado, para enriquecer la práctica investigativa.

- **Plugins y extensiones para recolección de evidencias:** Si el objetivo de la tesis es generar laboratorios de análisis forense, vale la pena considerar cómo **extender CALDERA** para facilitar la recopilación de evidencias post-operación. Por ejemplo, el *plugin* **Debrief** de CALDERA provee resúmenes de las operaciones realizadas (qué técnicas se ejecutaron, en qué hosts, con qué resultado) ([GitHub - mitre/caldera: Automated Adversary Emulation Platform](https://github.com/mitre/caldera#:~:text=,Response%20%28incident%20response)). Aunque está pensado para el equipo rojo, estos reportes pueden servir al instructor como “verdad terreno” para verificar que los estudiantes encontraron todos los puntos relevantes. Asimismo, dado que CALDERA es extensible, se podría desarrollar un módulo que, tras ejecutar el escenario, automaticamente recopile ciertos logs o snapshots de sistemas (por ej., ejecutar un `Collector` que junte el *Windows Event Log* y lo guarde, o que tome una imagen de memoria). Esto se podría integrar como una fase final de la operación (blue team). De hecho, usando el plugin **Response**, se podrían encadenar tareas de respuesta como *dump de memoria* o *colección de logs* tras el ataque ([GitHub - mitre/response: A CALDERA plugin for autonomous incident response](https://github.com/mitre/response#:~:text=A%20MITRE%20Caldera%20plugin%20for,doing%20autonomous%20incident%20response)), simulando que un SOC automatizado está preservando evidencia. Tales artefactos recolectados serían exactamente el insumo para los ejercicios de análisis forense posteriores.

En conclusión, mediante el uso creativo de CALDERA y sus extensiones, es posible **generar un entorno ricamente instrumentado con artefactos forenses auténticos**: registros de sistema, tráfico de red, cambios en archivos y configuración, etc. Esto cumple el objetivo de la tesis de proveer laboratorios realistas de análisis forense y gestión de incidentes en cyber ranges, ya que los estudiantes pueden practicar el ciclo completo de *detección, investigación y respuesta* sobre incidentes simulados de manera repetible y controlada ([A Beginner’s Guide to Adversary Emulation with Caldera – NVISO Labs](https://blog.nviso.eu/2023/08/25/a-beginners-guide-to-adversary-emulation-with-caldera/#:~:text=MITRE%E2%80%99s%20Caldera%20project%20is%20an,comprehensive%20view%20of%20an%20organization%E2%80%99s)). La combinación de ataques automatizados (Red Team) y monitorización/respuesta (Blue Team) que ofrece CALDERA, alineada con ATT&CK y complementada con herramientas de logging, convierte a plataformas como Tectonic en poderosos entornos educativos para formar a la próxima generación de analistas forenses e investigadores de incidentes. Todas las evidencias generadas en estos escenarios –desde un simple log hasta una captura de red o un artefacto en disco– serán la base sobre la cual los estudiantes apliquen métodos forenses, logrando así el cometido de la integración de CALDERA en la tesis propuesta. ([GitHub - mitre/caldera: Automated Adversary Emulation Platform](https://github.com/mitre/caldera#:~:text=MITRE%20Caldera%E2%84%A2%20is%20a%20cyber,teams%2C%20and%20automate%20incident%20response)) ([Microsoft Word - Caldera Fact Sheet - Use Cases - Official.docx](https://caldera.readthedocs.io/en/latest/_downloads/90787a16a6f86ad42b590a7e92140520/Caldera_Use_Cases.pdf#:~:text=Research%20%E2%80%A2%20Train%20computer%20incident,documentation%20%26%20interactive%20tutorials%20Training))

